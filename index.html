<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>My Redux</title>
</head>
<script src="https://unpkg.com/redux@4.0.4/dist/redux.min.js"></script>
<script src="https://unpkg.com/redux-thunk@2.1.0/dist/redux-thunk.min.js"></script>
<script src="https://unpkg.com/react@16.9.0/umd/react.development.js"></script>
<script src="https://unpkg.com/react-dom@16.9.0/umd/react-dom.production.min.js"></script>
<script src="https://unpkg.com/babel-standalone@6.26.0/babel.min.js"></script>

<script src="index.js"></script>
<script src="actions.js"></script>
<body>
    <h1>Mi equipo de futbol</h1>


    <button onclick="clearClick()">Clear</button>

    <hr />
    <div id="react-app"></div>



<script type="text/babel">
    function TeamName({ teamName, onTeamNameSave }) {
       function handleSaveTeamName() {
          const teamName = document.getElementById('txtTeamName').value;
          onTeamNameSave(teamName)
       }

       return (
          <div>
             <input id="txtTeamName" placeholder="Nombre del equipo"/>
             <button onClick={handleSaveTeamName}>Guardar</button>
             <br/>
             Equipo guardado: <h2 id="teamNameLabel">{teamName}</h2>
          </div>
       );
    }

    class ConnectedTeamName extends React.Component {
       componentDidMount() {
          store.subscribe(() => {
             this.forceUpdate()
          })
       }
       onTeamNameSave = teamName => {
          //alert(teamName)
          store.dispatch(saveTeamNameThunk(teamName))
       }

       render() {
          return (
             <TeamName
                teamName={store.getState().teamName}
                onTeamNameSave={this.onTeamNameSave}
             />
          )
       }
    }

    function Players({ players, onAddPlayer, onRemovePlayer }) {
       function handleAddPlayer() {
          const playerName = document.getElementById('txtPlayerName').value;
          onAddPlayer(playerName)
       }

       return (
          <div>
             <h3>Jugadores</h3>
             <input id="txtPlayerName"/>
             <button onClick={handleAddPlayer}>Agregar jugador</button>
             <ul id="players">
                {players.map( player => (
                   <li key={player}>
                      {player}
                      <button onClick={() => onRemovePlayer(player)}> X </button>
                   </li>
                ))}
             </ul>
          </div>
       );
    }

    class ConnectedPlayers extends React.Component {
       componentDidMount() {
          store.subscribe(() => {
             this.forceUpdate()
          })
       }
       onAddPlayer = playerName => {
          store.dispatch(addPlayerAction(playerName))
       }

       onRemovePlayer = playerName => {
          store.dispatch(removePlayerAction(playerName))
       }

       render() {
          return (
             <Players
                players={store.getState().players}
                onAddPlayer={ this.onAddPlayer }
                onRemovePlayer={ this.onRemovePlayer }
             />
          )
       }
    }


    class App extends React.Component {
       render() {
          return (
             <div>
                 <ConnectedTeamName />
                 <ConnectedPlayers/>
             </div>
          )
       }
    }
    ReactDOM.render(
       <App />,
       document.getElementById('react-app')
    )
</script>
<script>
    /*store.subscribe(function(){
       const stateTree = store.getState();
       stateToUI(stateTree, function(playerName) {
          store.dispatch(removePlayerAction(playerName))
       })
    })

    function stateToUI(stateTree, onRemoveBtnClick) {
       const players = stateTree.players;
       const teamName = stateTree.teamName;
       document.getElementById('teamNameLabel').innerHTML = teamName;
       const ul = document.getElementById('players');
       ul.innerHTML = "";
       players.forEach(p => {
          const li = document.createElement('li');
          li.innerHTML = p;
          const removeBtn = document.createElement('button');
          removeBtn.innerHTML = 'X';
          removeBtn.addEventListener('click', () => {
             onRemoveBtnClick(p)
          })
          li.appendChild(removeBtn);

          ul.appendChild(li);
       })
    }

    function addPlayer() {
       const playerName = document.getElementById('txtPlayerName').value;
       store.dispatch(addPlayerAction(playerName))
    }

    function saveTeamName() {
       const teamName = document.getElementById('txtTeamName').value;
       store.dispatch(saveTeamNameThunk(teamName))
    }

    function clearClick() {
       store.dispatch(clearAction())
    }*/
</script>
</body>
</html>